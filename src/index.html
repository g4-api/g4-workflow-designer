<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

	<title>Sequential Workflow Designer</title>
	<link rel="icon" href="./images/favicon.ico" />
	<link href="./css/designer.css" rel="stylesheet">
	<link href="./css/designer-light.css" rel="stylesheet">
	<link href="./css/designer-dark.css" rel="stylesheet">
	<style>
		body,
		input,
		select,
		button {
			font:
				14px/1.3em 'Open Sans',
				Arial,
				Verdana,
				Serif;
		}

		html,
		body {
			width: 100vw;
			height: 100vh;
			margin: 0;
			padding: 0;
			overflow: hidden;
		}

		#designer {
			position: absolute;
			left: 0;
			top: 0;
			width: 100vw;
			height: 100vh;
		}

		.sqd-editor {
			padding: 10px;
		}

		.sqd-editor p {
			margin: 0;
			padding: 0 0 10px;
		}

		.sqd-smart-editor {
			height: 100%;
			overflow: auto;
		}

		.sqd-editor label,
		.label-text {
			font-weight: 700;
			font-size: 1.05em;
			margin-top: 0;
		}

		.sqd-layout-desktop .sqd-smart-editor {
			width: 350px;
		}

		.sqd-layout-desktop .sqd-smart-editor-toggle {
			right: 350px;
		}

		.sqd-editor input[type='text'],
		input[type="number"],
		input[list],
		select,
		textarea {
			width: 100%;
			box-sizing: border-box;
			border: 1px solid silver;
			padding: 6px;
			border-radius: 0px;
			line-height: 1.3em;
			min-height: 31.33px;
		}

		.sqd-editor textarea {
			margin: 0px;
			min-height: 55px;
		}

		.sqd-editor div[data-g4-role='field'] {
			margin-top: 1em;
		}

		.sqd-editor div[data-g4-role='hint'] {
			margin-top: 0.25em;
			margin-bottom: 0.25em;
		}

		.sqd-editor input[type='text']:focus,
		input[type="number"]:focus,
		input[list]:focus,
		select:focus,
		textarea:focus {
			border: 1px solid #000;
			outline: none;
		}

		.sqd-editor input[type='text']:read-only,
		input[type="number"]:read-only {
			background: #f4f4f4;
			border-color: #ddd;
			color: #999;
		}

		.sqd-editor textarea {
			resize: none;
			white-space: pre;
			overflow-y: hidden;
			overflow-x: auto;
		}

		#result {
			position: absolute;
			right: 0;
			bottom: 0;
			width: 30vw;
			height: 100vh;
			padding: 10px;
			box-sizing: border-box;
			color: #fff;
			background: #2c18df;
		}

		#result a.github {
			color: #fff;
			display: inline-block;
			margin: 6px 8px;
		}

		#result a.github:hover {
			text-decoration: none;
		}

		#result button {
			padding: 10px;
			color: #000;
			background: #fff;
			border: 0;
			border-radius: 5px;
			cursor: pointer;
		}

		#result button:hover {
			opacity: 0.8;
		}

		.subtitle {
			display: block;
			margin-bottom: 15px;
			font-size: 1.2em;
			font-weight: 500;
		}
	</style>

	<style>
		/* Box-sizing Reset */
		*,
		*::before,
		*::after {
			box-sizing: border-box;
		}

		/* Flexbox Container for Label */
		.label-with-icon {
			display: flex;
			align-items: center;
			justify-content: space-between;
			font-family: Arial, sans-serif;
			width: 100%;
			font-size: 16px;
		}

		/* SVG Icon Styling */
		.hint-icon-container {
			position: relative;
			cursor: pointer;
			align-items: center;
			font: 14px/1.3em Arial, Verdana, sans-serif;
			line-height: 1.3em;
			display: block;
			width: 18px;
			height: 18px;
			background: #ddd;
			border-radius: 50% 50%;
			text-align: center;
			font-size: 11px;
			cursor: pointer;
		}

		.hint-icon {
			font: 14px/1.3em Arial, Verdana, sans-serif;
			line-height: 1.3em;
			text-align: center;
			font-size: 11px;
			cursor: pointer;
			width: 64%;
			height: 64%;
			margin: 18%;
		}

		/* Change icon color on hover/focus */
		.hint-icon-container:hover .hint-icon,
		.hint-icon-container:focus .hint-icon {
			fill: #007BFF;
		}

		.hint-text {
			font: 14px/1.3em Arial, Verdana, sans-serif;
			font-size: 13px;
			line-height: 1.3em;
			padding: 6px 10px;
			border-radius: 0px;
			background: #eee;
			border: 1px solid #ddd;
		}

		div[data-g4-role='input-row'],
		div[data-g4-role='keyvalue'],
		.input-row {
			display: flex;
			align-items: center;
			margin: 0.2em 0;
		}

		.add-button {
			position: absolute;
			top: 0;
			right: 0;
			background: none;
			border: none;
			font-size: 20px;
			cursor: pointer;
			line-height: 1;
		}

		div[data-g4-role='input-row'],
		div[data-g4-role='keyvalue'],
		.text-with-button {
			box-sizing: border-box;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		div[data-g4-role='input-row'] button,
		div[data-g4-role='keyvalue'] button,
		.text-with-button button {
			box-sizing: border-box;
			border: 1px solid silver;
			padding: 6px;
			border-radius: 0px;
			line-height: 1.3em;
			min-width: 32.19px;
			cursor: pointer;
		}

		div[data-g4-role='input-row'] input[type="text"],
		div[data-g4-role='keyvalue'] input[type="text"],
		.text-with-button input[type="text"],
		textarea {
			margin-left: 0.2em;
		}

		button svg {
			width: 1em;
			height: 1em;
			vertical-align: middle;
		}
	</style>

	<style>
		details {
			border: 1px solid silver;
			border-radius: 0px;
			padding: 10px;
			max-width: 500px;
			margin: 0.25em auto;
		}

		summary {
			font-size: 1.2em;
			cursor: pointer;
			outline: none;
		}

		.content {
			margin-top: 10px;
			animation: fadeIn 0.3s ease-in-out;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
			}

			to {
				opacity: 1;
			}
		}
	</style>
</head>

<body>
	<div id="designer"></div>

	<!-- <div id="result">
		<p>
			<button id="run">Run</button>
		</p>

		<h5>Variables</h5>
		<pre id="variables"></pre>

		<h5>Console</h5>
		<pre id="console"></pre>
	</div> -->

	<script src="./js/custom-fields.js"></script>
	<script src="./js/index.umd.js"></script>
	<script src="./js/state-machine.js"></script>
	<script src="./js/index.js"></script>

	<script>
		function waitForElement(selector, timeout = 5000) {
			return new Promise((resolve, reject) => {
				const interval = 100; // Check every 100ms
				let elapsedTime = 0;

				const intervalId = setInterval(() => {
					const element = document.querySelector(selector);
					if (element) {
						clearInterval(intervalId);
						resolve(element);
					} else {
						elapsedTime += interval;
						if (elapsedTime >= timeout) {
							clearInterval(intervalId);
							reject(new Error(`Timeout waiting for element: ${selector}`));
						}
					}
				}, interval);
			});
		}

		// Use the waitForElement function
		waitForElement('.sqd-control-bar', 5000)
			.then((controlBar) => {
				const exportSvg = "M960 608a32 32 0 0 0-32 32v288h-288a32 32 0 0 0 0 64h320a32 32 0 0 0 32-32V640a32 32 0 0 0-32-32zM512 928h-128a32 32 0 0 0 0 64h128a32 32 0 0 0 0-64zM278.72 937.28a32 32 0 0 0-34.88-6.72 29.76 29.76 0 0 0-10.56 6.72 32 32 0 0 0-6.72 10.56A32 32 0 0 0 224 960a32 32 0 0 0 54.72 22.72 37.12 37.12 0 0 0 6.72-10.56 30.08 30.08 0 0 0 0-24.32 29.76 29.76 0 0 0-6.72-10.56zM128 928H96v-288a32 32 0 0 0-64 0v320a32 32 0 0 0 32 32h64a32 32 0 0 0 0-64zM743.68 491.2a32 32 0 1 0 48.64 41.6l192-224a30.08 30.08 0 0 0 1.92-3.52 32 32 0 0 0 2.56-4.16v-2.24a32 32 0 0 0 0-5.12A32 32 0 0 0 992 288a32 32 0 0 0 0-4.8 32 32 0 0 0 0-5.12v-2.24a32 32 0 0 0-2.56-4.16 30.08 30.08 0 0 0-1.92-3.52l-192-224a32 32 0 0 0-48.64 41.6L890.56 256H480v480a32 32 0 0 0 64 0V320h346.56z";
				const importSvg = "M960 608a32 32 0 0 0-32 32v288h-288a32 32 0 0 0 0 64h320a32 32 0 0 0 32-32V640a32 32 0 0 0-32-32zM512 928h-128a32 32 0 0 0 0 64h128a32 32 0 0 0 0-64zM278.72 937.28a32 32 0 0 0-34.88-6.72 29.76 29.76 0 0 0-10.56 6.72 32 32 0 0 0-6.72 10.56A32 32 0 0 0 224 960a32 32 0 0 0 54.72 22.72 37.12 37.12 0 0 0 6.72-10.56 30.08 30.08 0 0 0 0-24.32 29.76 29.76 0 0 0-6.72-10.56zM128 928H96v-288a32 32 0 0 0-64 0v320a32 32 0 0 0 32 32h64a32 32 0 0 0 0-64zM64 96h416v570.56l-171.2-146.88a32 32 0 0 0-41.6 48.64l224 192a32 32 0 0 0 4.8 2.88l2.56 1.6a30.08 30.08 0 0 0 23.36 0l2.24-1.6a32 32 0 0 0 4.8-2.88l224-192a32 32 0 0 0-41.6-48.64L544 666.56V64a32 32 0 0 0-32-32H64a32 32 0 0 0 0 64z";
				const startSvg = "M10,10 L90,50 L10,90 Z";
				const stopSvg = "M10,10 L90,10 L90,90 L10,90 Z";

				const exportButtonContianer = document.createElement("div");
				exportButtonContianer.classList.add('sqd-control-bar-button');
				exportButtonContianer.title = "Export Definition";

				const exportSvgElement = document.createElement("svg");
				exportSvgElement.classList.add('sqd-control-bar-button-icon');
				exportSvgElement.setAttribute('viewBox', '0 0 1024 1024');

				const exportPathElement = document.createElement("path");
				exportPathElement.setAttribute('d', exportSvg);
				exportPathElement.classList.add('sqd-icon-path');

				exportSvgElement.appendChild(exportPathElement);
				exportButtonContianer.appendChild(exportSvgElement);

				//controlBar.prepend(exportButtonContianer.outerHTML);
				controlBar.insertAdjacentHTML('afterbegin', exportButtonContianer.outerHTML);

				const importButtonContianer = document.createElement("div");
				importButtonContianer.classList.add('sqd-control-bar-button');
				importButtonContianer.title = "Import Definition";

				const importSvgElement = document.createElement("svg");
				importSvgElement.classList.add('sqd-control-bar-button-icon');
				importSvgElement.setAttribute('viewBox', '0 0 1024 1024');

				const importPathElement = document.createElement("path");
				importPathElement.setAttribute('d', importSvg);
				importPathElement.classList.add('sqd-icon-path');

				importSvgElement.appendChild(importPathElement);
				importButtonContianer.appendChild(importSvgElement);

				controlBar.insertAdjacentHTML('afterbegin', importButtonContianer.outerHTML);




				const stopButtonContianer = document.createElement("div");
				stopButtonContianer.id = "stop";
				stopButtonContianer.classList.add('sqd-control-bar-button');
				stopButtonContianer.title = "Stop Definition";

				const stopSvgElement = document.createElement("svg");
				stopSvgElement.classList.add('sqd-control-bar-button-icon');
				stopSvgElement.setAttribute('viewBox', '0 0 100 100');

				const stopPathElement = document.createElement("path");
				stopPathElement.setAttribute('d', stopSvg);
				stopPathElement.classList.add('sqd-icon-path');

				stopSvgElement.appendChild(stopPathElement);
				stopButtonContianer.appendChild(stopSvgElement);

				controlBar.insertAdjacentHTML('afterbegin', stopButtonContianer.outerHTML);

				// Attach an event listener to the "Run" button for executing workflows.
				document.getElementById('stop').addEventListener('click', ()=>{
					console.log('Run clicked');
				});


				const startButtonContianer = document.createElement("div");
				startButtonContianer.id = "run";
				startButtonContianer.classList.add('sqd-control-bar-button');
				startButtonContianer.title = "Start Definition";

				const startSvgElement = document.createElement("svg");
				startSvgElement.classList.add('sqd-control-bar-button-icon');
				startSvgElement.setAttribute('viewBox', '0 0 100 100');

				const startPathElement = document.createElement("path");
				startPathElement.setAttribute('d', startSvg);
				startPathElement.classList.add('sqd-icon-path');

				startSvgElement.appendChild(startPathElement);
				startButtonContianer.appendChild(startSvgElement);

				controlBar.insertAdjacentHTML('afterbegin', startButtonContianer.outerHTML);

				// Attach an event listener to the "Run" button for executing workflows.
				document.getElementById('run').addEventListener('click', onRunClicked);
			});
	</script>

</html>